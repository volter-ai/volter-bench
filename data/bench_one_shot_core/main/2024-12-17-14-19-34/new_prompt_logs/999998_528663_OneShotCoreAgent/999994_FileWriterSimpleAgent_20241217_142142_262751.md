Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
1. Analysis and Solution:
The issue is that we need to reset creature states when exiting the MainGameScene. Looking at the architecture:

- We can't add methods to models since they must be pure data schemas
- The scene is responsible for managing game state
- We need to reset HP to max_hp before transitioning

The solution is to add a reset step in MainGameScene before transitioning back to MainMenuScene. We'll do this by setting each creature's hp back to its max_hp value before calling _transition_to_scene.

2. Here's the fixed MainGameScene:

# Excerpt ID: d1f648d9-02c6-401a-aed5-6a3c1dc9dbb5
```python main_game/scenes/main_game_scene.py
from mini_game_engine.engine.lib import AbstractGameScene, Button, SelectThing

class MainGameScene(AbstractGameScene):
    def __init__(self, app, player):
        super().__init__(app, player)
        self.bot = app.create_bot("default_player")
        self.player_creature = self.player.creatures[0]
        self.bot_creature = self.bot.creatures[0]
        self.queued_skills = []

    def __str__(self):
        return f"""=== Battle Scene ===
Your {self.player_creature.display_name}: HP {self.player_creature.hp}/{self.player_creature.max_hp}
Foe's {self.bot_creature.display_name}: HP {self.bot_creature.hp}/{self.bot_creature.max_hp}

Available Skills:
{chr(10).join([f"> {skill.display_name} ({skill.damage} damage)" for skill in self.player_creature.skills])}
"""

    def _reset_creatures(self):
        # Reset all creatures to their max HP
        for creature in self.player.creatures:
            creature.hp = creature.max_hp
        for creature in self.bot.creatures:
            creature.hp = creature.max_hp

    def _end_battle(self, message_to_player: str, message_to_bot: str):
        self._show_text(self.player, message_to_player)
        self._show_text(self.bot, message_to_bot)
        self._reset_creatures()
        self._transition_to_scene("MainMenuScene")

    def run(self):
        self._show_text(self.player, "Battle Start!")
        self._show_text(self.bot, "Battle Start!")

        while True:
            # Player phase
            choices = [SelectThing(skill) for skill in self.player_creature.skills]
            player_choice = self._wait_for_choice(self.player, choices)
            self.queued_skills.append((self.player, player_choice.thing))

            # Bot phase
            bot_choices = [SelectThing(skill) for skill in self.bot_creature.skills]
            bot_choice = self._wait_for_choice(self.bot, bot_choices)
            self.queued_skills.append((self.bot, bot_choice.thing))

            # Resolution phase
            for attacker, skill in self.queued_skills:
                if attacker == self.player:
                    self.bot_creature.hp -= skill.damage
                    self._show_text(self.player, f"Your {self.player_creature.display_name} used {skill.display_name}!")
                    self._show_text(self.bot, f"Foe's {self.player_creature.display_name} used {skill.display_name}!")
                    if self.bot_creature.hp <= 0:
                        self._end_battle("You won!", "You lost!")
                        return
                else:
                    self.player_creature.hp -= skill.damage
                    self._show_text(self.player, f"Foe's {self.bot_creature.display_name} used {skill.display_name}!")
                    self._show_text(self.bot, f"Your {self.bot_creature.display_name} used {skill.display_name}!")
                    if self.player_creature.hp <= 0:
                        self._end_battle("You lost!", "You won!")
                        return

            self.queued_skills.clear()
```

The changes:
1. Added `_reset_creatures()` method to handle resetting HP values
2. Added `_end_battle()` method to encapsulate the end-game logic including resetting creatures
3. Modified the battle resolution to use `_end_battle()` instead of direct transitions
4. Ensures creatures are reset before any scene transition

This maintains the pure data schema nature of the models while properly managing game state within the scene.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
