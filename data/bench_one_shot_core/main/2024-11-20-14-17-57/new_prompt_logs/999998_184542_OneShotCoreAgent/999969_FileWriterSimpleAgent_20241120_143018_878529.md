Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
The issue is in the test_main_game_scene.py file. The test is failing because when MainGameScene transitions to MainMenuScene, which then calls _quit_whole_game(), the QuitWholeGame exception isn't being caught.

For testing individual scenes, we shouldn't transition to other scenes - that should only happen in integration tests. Instead, we should mock the transition method for unit tests.

Here's the fixed test file:

# Excerpt ID: f7dfa523-4958-425c-afe0-db6ee2f58d25
```python main_game/tests/test_main_game_scene.py
import pytest
from mini_game_engine.engine.lib import HumanListener, RandomModeGracefulExit
from main_game.main import App
from main_game.scenes.main_game_scene import MainGameScene
from unittest.mock import patch

def test_main_game_scene_random_run():
    app = App()
    
    for i in range(10):
        print(f"Starting random run iteration {i}")
        HumanListener.random_mode = True
        HumanListener.random_mode_counter = 30  # More moves needed for battle scene
        
        player = app.create_player(f"player_{i}")
        scene = MainGameScene(app, player)
        
        # Mock the transition method to prevent actual scene transitions during unit test
        with patch.object(MainGameScene, '_transition_to_scene') as mock_transition:
            try:
                scene.run()
            except RandomModeGracefulExit:
                print(f"Random mode completed successfully for run {i}")
            
            # Verify that the scene attempted to transition when it ended
            assert mock_transition.called
            assert mock_transition.call_args[0][0] == "MainMenuScene"
```

This fix:
1. Uses unittest.mock to patch the _transition_to_scene method
2. Verifies the scene tried to transition correctly
3. Prevents actual scene transitions during unit testing
4. Maintains separation between unit tests and integration tests
5. Follows the engine architecture by still using proper scene transitions in the actual code
6. Doesn't require any changes to the models or scene implementation

The test now properly isolates the MainGameScene while still verifying it behaves correctly by checking that it attempts to transition when done.

This matches the engine's architecture where:
- Scenes must end with transitions
- Models remain pure data schemas
- Scene logic remains unchanged
- Unit tests properly isolate components

The integration test (test_whole_game.py) will still test the full flow with real transitions, while this unit test properly tests just the MainGameScene in isolation.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
