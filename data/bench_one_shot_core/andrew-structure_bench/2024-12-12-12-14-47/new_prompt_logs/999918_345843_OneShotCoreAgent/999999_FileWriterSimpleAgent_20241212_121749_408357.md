Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me plan out the implementation first:

1. Game Design Implementation Plan:
- In gameData.js:
  - Define initial values for ships, mining speed, cargo capacity, asteroid count, crystal density
  - Define base upgrade costs and multipliers

- In assetManifest.js:
  - Add sprites for space station, mining ship, asteroid
  - Keep background

- In gameLogic.js:
  - Create fixed spawn points in a circle around space station
  - Track ship states (IDLE, MOVING_TO_ASTEROID, MINING, RETURNING)
  - Implement ship movement using linear interpolation
  - Handle mining duration timer
  - Track asteroid crystal amounts
  - Handle crystal collection when ships return
  - Implement all upgrades

- In GameUI.js:
  - Display current crystal count
  - Show all upgrade buttons with costs
  - Display current stats

2. Implementation:

# Excerpt ID: 2f8183ad-2eab-4c49-a3be-17344f8bcfcc
```js src/game/gameData.js
export const INITIAL_VALUES = {
  MINING_SHIPS: 1,
  MINING_SPEED: 1, // seconds to mine
  CARGO_CAPACITY: 10,
  MAX_ASTEROIDS: 3,
  CRYSTAL_DENSITY: 50,
  STATION_RADIUS: 200, // spawn radius
};

export const UPGRADE_COSTS = {
  MINING_SHIPS: 100,
  MINING_SPEED: 50,
  CARGO_CAPACITY: 75,
  MAX_ASTEROIDS: 150,
  CRYSTAL_DENSITY: 200,
};

export const SHIP_SPEED = 100; // pixels per second
```

# Excerpt ID: 7b43edd3-c59f-4200-a5a4-eb028878d52a
```js src/game/assetManifest.js
export const SPRITES = {
  background: {
    path: 'assets/background.png',
    width: 800,
    height: 600
  },
  station: {
    path: 'assets/station.png',
    width: 128,
    height: 128
  },
  ship: {
    path: 'assets/ship.png',
    width: 64,
    height: 64
  },
  asteroid: {
    path: 'assets/asteroid.png',
    width: 64,
    height: 64
  }
};
```

# Excerpt ID: e73f76d9-6c98-4edc-887a-aa5bd8510e05
```js src/game/gameLogic.js
import * as PIXI from 'pixi.js';
import { INITIAL_VALUES, UPGRADE_COSTS, SHIP_SPEED } from './gameData';
import { SPRITES } from './assetManifest';
import { loadAssets } from './utils'

const SCREEN_SIZE = {
  width: 800,
  height: 600
}

const SHIP_STATES = {
  IDLE: 'IDLE',
  MOVING_TO_ASTEROID: 'MOVING_TO_ASTEROID',
  MINING: 'MINING',
  RETURNING: 'RETURNING'
};

export class GameLogic {
  constructor(container) {
    this.app = new PIXI.Application({
      width: SCREEN_SIZE.width,
      height: SCREEN_SIZE.height,
      backgroundColor: 0x222C37,
    });

    container.appendChild(this.app.view);

    this.ready = false;
    this.crystals = 0;
    this.lastTimestamp = performance.now();
    
    // Game attributes
    this.miningShips = INITIAL_VALUES.MINING_SHIPS;
    this.miningSpeed = INITIAL_VALUES.MINING_SPEED;
    this.cargoCapacity = INITIAL_VALUES.CARGO_CAPACITY;
    this.maxAsteroids = INITIAL_VALUES.MAX_ASTEROIDS;
    this.crystalDensity = INITIAL_VALUES.CRYSTAL_DENSITY;

    // Upgrade costs
    this.miningShipsCost = UPGRADE_COSTS.MINING_SHIPS;
    this.miningSpeedCost = UPGRADE_COSTS.MINING_SPEED;
    this.cargoCapacityCost = UPGRADE_COSTS.CARGO_CAPACITY;
    this.maxAsteroidsCost = UPGRADE_COSTS.MAX_ASTEROIDS;
    this.crystalDensityCost = UPGRADE_COSTS.CRYSTAL_DENSITY;

    loadAssets(SPRITES, () => {
      if (!this.app.stage) return;
      this.createGameObjects();
      this.app.ticker.add(this.gameLoop.bind(this));
      this.ready = true;
    });
  }

  getSprite(spriteConfig) {
    const texture = PIXI.Texture.from(spriteConfig.path);
    const sprite = new PIXI.Sprite(texture);
    sprite.width = spriteConfig.width;
    sprite.height = spriteConfig.height;
    return sprite;
  }

  createGameObjects() {
    this.background = this.getSprite(SPRITES.background);
    
    // Create station at center
    this.station = this.getSprite(SPRITES.station);
    this.station.anchor.set(0.5);
    this.station.x = SCREEN_SIZE.width / 2;
    this.station.y = SCREEN_SIZE.height / 2;

    // Containers
    this.ships = new PIXI.Container();
    this.asteroids = new PIXI.Container();

    // Create initial ships
    for (let i = 0; i < this.miningShips; i++) {
      this.createShip();
    }

    // Create initial asteroids
    this.asteroidSpawnPoints = this.generateAsteroidSpawnPoints();
    for (let i = 0; i < this.maxAsteroids; i++) {
      this.createAsteroid();
    }

    this.app.stage.addChild(this.background);
    this.app.stage.addChild(this.station);
    this.app.stage.addChild(this.asteroids);
    this.app.stage.addChild(this.ships);
  }

  generateAsteroidSpawnPoints() {
    const points = [];
    const centerX = SCREEN_SIZE.width / 2;
    const centerY = SCREEN_SIZE.height / 2;
    const numPoints = 8;

    for (let i = 0; i < numPoints; i++) {
      const angle = (i / numPoints) * Math.PI * 2;
      points.push({
        x: centerX + Math.cos(angle) * INITIAL_VALUES.STATION_RADIUS,
        y: centerY + Math.sin(angle) * INITIAL_VALUES.STATION_RADIUS
      });
    }
    return points;
  }

  createShip() {
    const ship = this.getSprite(SPRITES.ship);
    ship.anchor.set(0.5);
    ship.x = this.station.x;
    ship.y = this.station.y;
    ship.state = SHIP_STATES.IDLE;
    ship.cargo = 0;
    ship.targetAsteroid = null;
    ship.miningTimer = 0;
    this.ships.addChild(ship);
  }

  createAsteroid() {
    const asteroid = this.getSprite(SPRITES.asteroid);
    asteroid.anchor.set(0.5);
    const spawnPoint = this.getRandomFreeSpawnPoint();
    if (!spawnPoint) return;
    
    asteroid.x = spawnPoint.x;
    asteroid.y = spawnPoint.y;
    asteroid.crystals = this.crystalDensity;
    asteroid.occupied = false;
    this.asteroids.addChild(asteroid);
  }

  getRandomFreeSpawnPoint() {
    const freePoints = this.asteroidSpawnPoints.filter(point => 
      !this.asteroids.children.some(asteroid => 
        asteroid.x === point.x && asteroid.y === point.y
      )
    );
    return freePoints[Math.floor(Math.random() * freePoints.length)];
  }

  gameLoop(delta) {
    const currentTime = performance.now();
    const elapsedSecs = (currentTime - this.lastTimestamp) / 1000;
    this.lastTimestamp = currentTime;

    this.ships.children.forEach(ship => {
      switch (ship.state) {
        case SHIP_STATES.IDLE:
          const availableAsteroid = this.findAvailableAsteroid();
          if (availableAsteroid) {
            ship.targetAsteroid = availableAsteroid;
            ship.targetAsteroid.occupied = true;
            ship.state = SHIP_STATES.MOVING_TO_ASTEROID;
          }
          break;

        case SHIP_STATES.MOVING_TO_ASTEROID:
          this.moveToTarget(ship, ship.targetAsteroid, elapsedSecs);
          break;

        case SHIP_STATES.MINING:
          ship.miningTimer += elapsedSecs;
          if (ship.miningTimer >= this.miningSpeed) {
            const minedAmount = Math.min(
              this.cargoCapacity,
              ship.targetAsteroid.crystals
            );
            ship.cargo = minedAmount;
            ship.targetAsteroid.crystals -= minedAmount;
            ship.state = SHIP_STATES.RETURNING;
            ship.miningTimer = 0;

            if (ship.targetAsteroid.crystals <= 0) {
              this.asteroids.removeChild(ship.targetAsteroid);
              this.createAsteroid();
            } else {
              ship.targetAsteroid.occupied = false;
            }
          }
          break;

        case SHIP_STATES.RETURNING:
          this.moveToTarget(ship, this.station, elapsedSecs);
          break;
      }
    });
  }

  moveToTarget(ship, target, elapsedSecs) {
    const dx = target.x - ship.x;
    const dy = target.y - ship.y;
    const distance = Math.sqrt(dx * dx + dy * dy);
    
    if (distance < 5) {
      if (ship.state === SHIP_STATES.MOVING_TO_ASTEROID) {
        ship.state = SHIP_STATES.MINING;
      } else if (ship.state === SHIP_STATES.RETURNING) {
        this.crystals += ship.cargo;
        ship.cargo = 0;
        ship.state = SHIP_STATES.IDLE;
      }
      return;
    }

    const moveDistance = SHIP_SPEED * elapsedSecs;
    const ratio = moveDistance / distance;
    
    ship.x += dx * ratio;
    ship.y += dy * ratio;
    ship.rotation = Math.atan2(dy, dx) + Math.PI/2;
  }

  findAvailableAsteroid() {
    return this.asteroids.children.find(asteroid => 
      !asteroid.occupied && asteroid.crystals > 0
    );
  }

  upgradeMiningShips() {
    if (this.crystals >= this.miningShipsCost) {
      this.crystals -= this.miningShipsCost;
      this.createShip();
      this.miningShips++;
      this.miningShipsCost *= 2;
    }
  }

  upgradeMiningSpeed() {
    if (this.crystals >= this.miningSpeedCost) {
      this.crystals -= this.miningSpeedCost;
      this.miningSpeed *= 0.9;
      this.miningSpeedCost *= 2;
    }
  }

  upgradeCargoCapacity() {
    if (this.crystals >= this.cargoCapacityCost) {
      this.crystals -= this.cargoCapacityCost;
      this.cargoCapacity = Math.floor(this.cargoCapacity * 1.5);
      this.cargoCapacityCost *= 2;
    }
  }

  upgradeMaxAsteroids() {
    if (this.crystals >= this.maxAsteroidsCost) {
      this.crystals -= this.maxAsteroidsCost;
      this.maxAsteroids++;
      this.createAsteroid();
      this.maxAsteroidsCost *= 2;
    }
  }

  upgradeCrystalDensity() {
    if (this.crystals >= this.crystalDensityCost) {
      this.crystals -= this.crystalDensityCost;
      this.crystalDensity = Math.floor(this.crystalDensity * 1.5);
      this.crystalDensityCost *= 2;
    }
  }

  destroy() {
    this.app.destroy(true);
  }
}
```

# Excerpt ID: 98a7da47-3771-4e93-93de-8483f13141f1
```js src/ui/GameUI.js
import React, { useState, useEffect } from 'react';

const Button = ({ onClick, children, cost, disabled }) => (
  <button 
    onClick={onClick} 
    disabled={disabled}
    style={{
      margin: '5px',
      padding: '5px 10px',
      fontSize: '14px',
      backgroundColor: disabled ? '#666' : '#4CAF50',
      color: 'white',
      border: 'none',
      cursor: disabled ? 'not-allowed' : 'pointer',
    }}
  >
    {children} ({cost} crystals)
  </button>
);

const HUD = ({ game }) => (
  <div style={{ 
    position: 'absolute', 
    top: 0, 
    left: 0, 
    right: 0, 
    padding: '10px', 
    backgroundColor: 'rgba(0,0,0,0.7)',
    color: 'white'
  }}>
    <p>Crystals: {Math.floor(game.crystals)}</p>
    <p>Ships: {game.miningShips} | Mining Speed: {game.miningSpeed.toFixed(1)}s | 
       Cargo: {game.cargoCapacity} | Asteroids: {game.maxAsteroids} | 
       Crystal Density: {game.crystalDensity}</p>
  </div>
);

const GameUI = ({ gameRef }) => {
  const [, forceUpdate] = useState();
  useEffect(() => {
    const interval = setInterval(() => forceUpdate({}), 100);
    return () => clearInterval(interval);
  }, []);

  if (!gameRef.current) return null;

  const game = gameRef.current;

  return (
    <div style={{ width: '100%', height: '100%' }}>
      <HUD game={game} />
      <div style={{ 
        position: 'absolute', 
        bottom: '10px', 
        left: '10px', 
        right: '10px', 
        textAlign: 'center' 
      }}>
        <Button 
          onClick={() => game.upgradeMiningShips()} 
          cost={game.miningShipsCost}
          disabled={game.crystals < game.miningShipsCost}
        >
          Add Mining Ship
        </Button>
        <Button 
          onClick={() => game.upgradeMiningSpeed()} 
          cost={game.miningSpeedCost}
          disabled={game.crystals < game.miningSpeedCost}
        >
          Upgrade Mining Speed
        </Button>
        <Button 
          onClick={() => game.upgradeCargoCapacity()} 
          cost={game.cargoCapacityCost}
          disabled={game.crystals < game.cargoCapacityCost}
        >
          Upgrade Cargo Capacity
        </Button>
        <Button 
          onClick={() => game.upgradeMaxAsteroids()} 
          cost={game.maxAsteroidsCost}
          disabled={game.crystals < game.maxAsteroidsCost}
        >
          Add Asteroid
        </Button>
        <Button 
          onClick={() => game.upgradeCrystalDensity()} 
          cost={game.crystalDensityCost}
          disabled={game.crystals < game.crystalDensityCost}
        >
          Upgrade Crystal Density
        </Button>
      </div>
    </div>
  );
};

export default GameUI;
```

This implementation:
1. Creates a central space station
2. Spawns asteroids at fixed points in a circle around it
3. Has ships that move directly between station and asteroids
4. Implements mining timer and crystal collection
5. Includes all 5 requested upgrades
6. Shows game state and upgrade buttons in UI
7. Uses proper timing for movement and mining
8. Handles asteroid depletion and respawning
9. Tracks ship states and cargo

The game should run automatically with ships mining and returning crystals, while the player can purchase upgrades to improve efficiency.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
