Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
1. Error Analysis:
The error "gsap is not defined" occurs because we're using gsap without importing it. In gameLogic.js, we're using gsap directly in these lines:

# Excerpt ID: 9511ce19-7026-4882-beae-8719959095d4
```javascript
// Line causing error:
gsap.to(servedCustomer, {
  alpha: 0,
  duration: 0.5,
  onComplete: () => {
    this.customers.removeChild(servedCustomer);
  }
});
```

We need to import gsap from the effects library since it's already imported there. Here's how to fix it:
1. Import gsap from 'gsap' at the top of gameLogic.js
2. Or use the GSAP instance from the effects library for consistency

Let's use the second approach for better consistency with the effects system.

Here's the complete fixed implementation:

# Excerpt ID: 2f86b18a-3c5e-4f08-9ed2-d23a4c1d5a6f
```javascript src/game/gameLogic.js
import * as PIXI from 'pixi.js';
import { INITIAL_VALUES, UPGRADE_COSTS, POSITIONS, MOVEMENT_POINTS } from './gameData';
import { SPRITES } from './assetManifest';
import { loadAssets } from './utils';
import { EffectsLibrary } from '../lib/effectsLib';
import { gsap } from 'gsap';

const SCREEN_SIZE = {
  width: 800,
  height: 600
}

export class GameLogic {
  constructor(container) {
    this.app = new PIXI.Application({
      width: SCREEN_SIZE.width,
      height: SCREEN_SIZE.height,
      backgroundColor: 0x222C37,
    });

    container.appendChild(this.app.view);
    this.effects = new EffectsLibrary(this.app);

    this.ready = false;
    this.money = 0;
    this.baristaSpeed = INITIAL_VALUES.BARISTA_SPEED;
    this.coffeeMakeTime = INITIAL_VALUES.COFFEE_MAKE_TIME;
    this.coffeePrice = INITIAL_VALUES.COFFEE_PRICE;
    this.customerCapacity = INITIAL_VALUES.CUSTOMER_CAPACITY;
    this.baristaCount = INITIAL_VALUES.BARISTA_COUNT;

    this.upgradeCosts = {
      barista: UPGRADE_COSTS.BARISTA,
      speed: UPGRADE_COSTS.SPEED,
      efficiency: UPGRADE_COSTS.COFFEE_EFFICIENCY,
      capacity: UPGRADE_COSTS.CAPACITY,
      price: UPGRADE_COSTS.PRICE
    };

    loadAssets(SPRITES, () => {
      if (!this.app.stage) return;
      
      this.createGameObjects();
      this.app.ticker.add(this.gameLoop.bind(this));
      this.ready = true;
    });
  }

  getSprite(key) {
    const spriteConfig = SPRITES[key];
    const texture = PIXI.Loader.shared.resources[key].texture;
    const sprite = new PIXI.Sprite(texture);
    sprite.width = spriteConfig.width;
    sprite.height = spriteConfig.height;
    return sprite;
  }

  createGameObjects() {
    this.background = this.getSprite('background');
    
    // Create coffee machine container
    this.coffeeMachineContainer = new PIXI.Container();
    const coffeeMachineSprite = this.getSprite('coffee_machine');
    this.coffeeMachineContainer.addChild(coffeeMachineSprite);
    this.coffeeMachineContainer.position.set(POSITIONS.COFFEE_MACHINE.x, POSITIONS.COFFEE_MACHINE.y);
    
    this.baristas = new PIXI.Container();
    this.customers = new PIXI.Container();
    this.customerQueue = [];

    this.app.stage.addChild(this.background);
    this.app.stage.addChild(this.coffeeMachineContainer);
    this.app.stage.addChild(this.baristas);
    this.app.stage.addChild(this.customers);

    this.createBarista();
    this.spawnCustomer();
  }

  createBarista() {
    const baristaContainer = new PIXI.Container();
    const baristaSprite = this.getSprite('barista');
    baristaSprite.anchor.set(0.5);
    baristaContainer.addChild(baristaSprite);
    
    // Add shadow
    this.effects.createShadow(baristaContainer, baristaSprite);
    this.effects.idleAnimation(baristaContainer);

    baristaContainer.position.set(MOVEMENT_POINTS.START.x, MOVEMENT_POINTS.START.y);
    baristaContainer.state = 'idle';
    baristaContainer.targetCustomer = null;
    baristaContainer.coffeeTimer = 0;
    baristaContainer.sprite = baristaSprite;

    this.baristas.addChild(baristaContainer);
    this.effects.spawnAnimation(baristaContainer);
  }

  spawnCustomer() {
    if (this.customerQueue.length >= this.customerCapacity) return;

    const customerContainer = new PIXI.Container();
    const customerSprite = this.getSprite('customer');
    customerSprite.anchor.set(0.5);
    customerContainer.addChild(customerSprite);
    
    // Add shadow
    this.effects.createShadow(customerContainer, customerSprite);

    customerContainer.position.set(
      POSITIONS.CUSTOMER_COUNTER.x,
      POSITIONS.CUSTOMER_COUNTER.y + this.customerQueue.length * POSITIONS.CUSTOMER_SPACING
    );
    customerContainer.state = 'waiting';
    customerContainer.sprite = customerSprite;

    this.customers.addChild(customerContainer);
    this.customerQueue.push(customerContainer);
    
    this.effects.spawnAnimation(customerContainer);
  }

  moveTowards(object, target, speed, delta) {
    const dx = target.x - object.x;
    const dy = target.y - object.y;
    const distance = Math.sqrt(dx * dx + dy * dy);
    
    if (distance < 1) return true;

    const movement = speed * delta;
    object.x += (dx / distance) * movement;
    object.y += (dy / distance) * movement;
    return false;
  }

  gameLoop(delta) {
    const elapsedSecs = delta / 60;

    this.baristas.children.forEach(barista => {
      switch(barista.state) {
        case 'idle':
          if (this.customerQueue.length > 0) {
            barista.targetCustomer = this.customerQueue[0];
            barista.state = 'moving_to_machine';
          }
          break;

        case 'moving_to_machine':
          if (this.moveTowards(barista, MOVEMENT_POINTS.COFFEE_MACHINE, this.baristaSpeed, elapsedSecs)) {
            barista.state = 'making_coffee';
            barista.coffeeTimer = 0;
            this.effects.createSpiralParticles(this.app.stage, {
              x: MOVEMENT_POINTS.COFFEE_MACHINE.x,
              y: MOVEMENT_POINTS.COFFEE_MACHINE.y
            });
          }
          break;

        case 'making_coffee':
          barista.coffeeTimer += elapsedSecs;
          if (barista.coffeeTimer >= this.coffeeMakeTime) {
            barista.state = 'serving';
          }
          break;

        case 'serving':
          if (this.moveTowards(barista, MOVEMENT_POINTS.SERVING, this.baristaSpeed, elapsedSecs)) {
            this.money += this.coffeePrice;
            const servedCustomer = this.customerQueue.shift();
            
            // Show money earned
            this.effects.showFloatingText(servedCustomer, `+$${this.coffeePrice}`);
            this.effects.createImpactEffect(this.app.stage, {
              x: servedCustomer.x,
              y: servedCustomer.y
            });

            // Remove customer with fade
            gsap.to(servedCustomer, {
              alpha: 0,
              duration: 0.5,
              onComplete: () => {
                this.customers.removeChild(servedCustomer);
              }
            });

            // Move remaining customers
            this.customerQueue.forEach((customer, index) => {
              gsap.to(customer, {
                y: POSITIONS.CUSTOMER_COUNTER.y + index * POSITIONS.CUSTOMER_SPACING,
                duration: 0.5
              });
            });

            barista.state = 'returning';
            this.spawnCustomer();
          }
          break;

        case 'returning':
          if (this.moveTowards(barista, MOVEMENT_POINTS.START, this.baristaSpeed, elapsedSecs)) {
            barista.state = 'idle';
            barista.targetCustomer = null;
          }
          break;
      }
    });
  }

  upgradeBarista() {
    if (this.money >= this.upgradeCosts.barista) {
      this.money -= this.upgradeCosts.barista;
      this.createBarista();
      this.upgradeCosts.barista *= 2;
      this.baristaCount++;
      this.effects.screenShake(this.app.stage);
      this.effects.createExplosionParticles(this.app.stage, {
        x: MOVEMENT_POINTS.START.x,
        y: MOVEMENT_POINTS.START.y
      });
    }
  }

  upgradeSpeed() {
    if (this.money >= this.upgradeCosts.speed) {
      this.money -= this.upgradeCosts.speed;
      this.baristaSpeed *= 1.2;
      this.upgradeCosts.speed *= 2;
      this.baristas.children.forEach(barista => {
        this.effects.highlightCharacter(barista.sprite);
      });
    }
  }

  upgradeEfficiency() {
    if (this.money >= this.upgradeCosts.efficiency) {
      this.money -= this.upgradeCosts.efficiency;
      this.coffeeMakeTime *= 0.8;
      this.upgradeCosts.efficiency *= 2;
      this.effects.flashColor(this.coffeeMachineContainer.children[0], {
        color: 0x00FF00
      });
    }
  }

  upgradeCapacity() {
    if (this.money >= this.upgradeCosts.capacity) {
      this.money -= this.upgradeCosts.capacity;
      this.customerCapacity++;
      this.upgradeCosts.capacity *= 2;
      this.spawnCustomer();
      this.effects.createExplosionParticles(this.app.stage, {
        x: POSITIONS.CUSTOMER_COUNTER.x,
        y: POSITIONS.CUSTOMER_COUNTER.y
      });
    }
  }

  upgradePrice() {
    if (this.money >= this.upgradeCosts.price) {
      this.money -= this.upgradeCosts.price;
      this.coffeePrice = Math.floor(this.coffeePrice * 1.2);
      this.upgradeCosts.price *= 2;
      this.effects.createSpiralParticles(this.app.stage, {
        x: POSITIONS.SERVING_COUNTER.x,
        y: POSITIONS.SERVING_COUNTER.y,
        color: 0xFFD700
      });
    }
  }

  destroy() {
    this.effects.destroyAll();
    this.app.destroy(true);
  }
}
```

The key change was adding the import statement for gsap at the top of the file. This ensures that the gsap animations will work properly throughout the game logic.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
