Role: system
Content: 
__________________
Role: info
Content: Starting Pytest run
__________________
Role: info
Content: Pytest failed with exit code 1. Output:
============================= test session starts ==============================
platform linux -- Python 3.11.9, pytest-7.3.1, pluggy-1.5.0
rootdir: [REDACT]/volter-monorepo/packages/lib-volter-mge2
configfile: pytest.ini
plugins: timeout-2.3.1, asyncio-0.23.8, Faker-30.10.0, cov-4.1.0, sugar-0.9.7, metadata-3.1.1, anyio-4.6.2.post1, html-3.2.0, time-machine-2.16.0
asyncio: mode=Mode.STRICT
collected 3 items

main_game/tests/test_main_game_scene.py .                                [ 33%]
main_game/tests/test_main_menu_scene.py .                                [ 66%]
main_game/tests/test_whole_game.py F                                     [100%]

=================================== FAILURES ===================================
_____________________ test_full_game_flow_random_with_bots _____________________

    def test_full_game_flow_random_with_bots():
        for i in range(10):
            print(f"starting random run iteration {i}")
            HumanListener.random_mode = True
            HumanListener.random_mode_counter = 100  # 100 moves suffice for running through some common scenarios in the game
            App.matchmaking_wait_time = 0
            original_wait_time = App.matchmaking_wait_time
    
            app = App()
    
            # Create a human player
            human_player = app.create_player("HumanPlayer")
            human_player.set_listener(HumanListener())
    
            try:
>               app.run(human_player)

main_game/tests/test_whole_game.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../../mge2/mini_game_engine/engine/lib.py:629: in run
    self.transition_to_scene(self.entry_point_scene_id, player=player)
../../../../mge2/mini_game_engine/engine/lib.py:745: in transition_to_scene
    self.__run_scene(scene)
../../../../mge2/mini_game_engine/engine/lib.py:789: in __run_scene
    scene.run()
main_game/scenes/main_menu_scene.py:20: in run
    self._transition_to_scene("MainGameScene")
../../../../mge2/mini_game_engine/engine/lib.py:462: in _transition_to_scene
    self._app.transition_to_scene(scene_name, player=self.player)
../../../../mge2/mini_game_engine/engine/lib.py:745: in transition_to_scene
    self.__run_scene(scene)
../../../../mge2/mini_game_engine/engine/lib.py:789: in __run_scene
    scene.run()
main_game/scenes/main_game_scene.py:47: in run
    self.resolve_turn(player_action, bot_action)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <main_game.scenes.main_game_scene.MainGameScene object at 0x[REDACTED]>
player_action = ('attack', <main_game.models.Skill object at 0x[REDACTED]>)
bot_action = None

    def resolve_turn(self, player_action, bot_action):
        # Handle swaps first
        if player_action[0] == "swap":
            self.player.active_creature = player_action[1]
            self._show_text(self.player, f"Go {player_action[1].display_name}!")
    
>       if bot_action[0] == "swap":
E       TypeError: 'NoneType' object is not subscriptable

main_game/scenes/main_game_scene.py:117: TypeError
----------------------------- Captured stdout call -----------------------------
starting random run iteration 0
broadcast: {'__type': 'OnGameStart'}
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 1
Go Dumbird!
Go Bubwool!
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
Foe sent out Dumbird!
No other creatures available!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
Dumbird was knocked out!
Go Scizard!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
You lost the battle!
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 2
Foe sent out Dumbird!
Dumbird used Tackle!
Bubwool used Tackle!
Dumbird used Tackle!
Bubwool used Lick!
Foe sent out Scizard!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Go Bubwool!
Foe sent out Dumbird!
Go Dumbird!
Go Bubwool!
Foe sent out Scizard!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard was knocked out!
Go Dumbird!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
You won the battle!
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 3
Go Dumbird!
Foe sent out Dumbird!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
Dumbird used Tackle!
Bubwool used Tackle!
Dumbird was knocked out!
Go Scizard!
Bubwool used Tackle!
Scizard used Tackle!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
No other creatures available!
BotListener:on_show_event:show_text: {'text': 'No other creatures available!'}
=========================== short test summary info ============================
FAILED main_game/tests/test_whole_game.py::test_full_game_flow_random_with_bots - TypeError: 'NoneType' object is not subscriptable
========================= 1 failed, 2 passed in [REDACTED]s ==========================
PYTEST_EXIT_CODE: 1

__________________
Role: info
Content: Traceback (most recent call last):
  File "/home/runner/_work/volter-monorepo/volter-monorepo/volter-monorepo/packages/lib-volter-mge2/mge_agents/internal/game/pytest_runner_agent/logic.py", line 30, in execute
    output = run_pytest(test_file_path, project_root=self.sdk.project_directory, verbose=self.verbose)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/_work/volter-monorepo/volter-monorepo/volter-monorepo/packages/lib-std-agents/agent_lib/random_run_utils.py", line 141, in run_pytest
    raise AssertionError(f"Pytest failed with exit code {exit_code}. Output:\n{output}")
AssertionError: Pytest failed with exit code 1. Output:
============================= test session starts ==============================
platform linux -- Python 3.11.9, pytest-7.3.1, pluggy-1.5.0
rootdir: [REDACT]/volter-monorepo/packages/lib-volter-mge2
configfile: pytest.ini
plugins: timeout-2.3.1, asyncio-0.23.8, Faker-30.10.0, cov-4.1.0, sugar-0.9.7, metadata-3.1.1, anyio-4.6.2.post1, html-3.2.0, time-machine-2.16.0
asyncio: mode=Mode.STRICT
collected 3 items

main_game/tests/test_main_game_scene.py .                                [ 33%]
main_game/tests/test_main_menu_scene.py .                                [ 66%]
main_game/tests/test_whole_game.py F                                     [100%]

=================================== FAILURES ===================================
_____________________ test_full_game_flow_random_with_bots _____________________

    def test_full_game_flow_random_with_bots():
        for i in range(10):
            print(f"starting random run iteration {i}")
            HumanListener.random_mode = True
            HumanListener.random_mode_counter = 100  # 100 moves suffice for running through some common scenarios in the game
            App.matchmaking_wait_time = 0
            original_wait_time = App.matchmaking_wait_time
    
            app = App()
    
            # Create a human player
            human_player = app.create_player("HumanPlayer")
            human_player.set_listener(HumanListener())
    
            try:
>               app.run(human_player)

main_game/tests/test_whole_game.py:23: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../../../mge2/mini_game_engine/engine/lib.py:629: in run
    self.transition_to_scene(self.entry_point_scene_id, player=player)
../../../../mge2/mini_game_engine/engine/lib.py:745: in transition_to_scene
    self.__run_scene(scene)
../../../../mge2/mini_game_engine/engine/lib.py:789: in __run_scene
    scene.run()
main_game/scenes/main_menu_scene.py:20: in run
    self._transition_to_scene("MainGameScene")
../../../../mge2/mini_game_engine/engine/lib.py:462: in _transition_to_scene
    self._app.transition_to_scene(scene_name, player=self.player)
../../../../mge2/mini_game_engine/engine/lib.py:745: in transition_to_scene
    self.__run_scene(scene)
../../../../mge2/mini_game_engine/engine/lib.py:789: in __run_scene
    scene.run()
main_game/scenes/main_game_scene.py:47: in run
    self.resolve_turn(player_action, bot_action)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <main_game.scenes.main_game_scene.MainGameScene object at 0x[REDACTED]>
player_action = ('attack', <main_game.models.Skill object at 0x[REDACTED]>)
bot_action = None

    def resolve_turn(self, player_action, bot_action):
        # Handle swaps first
        if player_action[0] == "swap":
            self.player.active_creature = player_action[1]
            self._show_text(self.player, f"Go {player_action[1].display_name}!")
    
>       if bot_action[0] == "swap":
E       TypeError: 'NoneType' object is not subscriptable

main_game/scenes/main_game_scene.py:117: TypeError
----------------------------- Captured stdout call -----------------------------
starting random run iteration 0
broadcast: {'__type': 'OnGameStart'}
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 1
Go Dumbird!
Go Bubwool!
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
Foe sent out Dumbird!
No other creatures available!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
Dumbird was knocked out!
Go Scizard!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
You lost the battle!
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 2
Foe sent out Dumbird!
Dumbird used Tackle!
Bubwool used Tackle!
Dumbird used Tackle!
Bubwool used Lick!
Foe sent out Scizard!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Go Bubwool!
Foe sent out Dumbird!
Go Dumbird!
Go Bubwool!
Foe sent out Scizard!
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
Go Dumbird!
Dumbird used Tackle!
Scizard used Fireball!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
Bubwool used Lick!
It's super effective!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
No other creatures available!
Bubwool used Tackle!
Scizard was knocked out!
Go Dumbird!
No other creatures available!
Dumbird used Tackle!
Bubwool used Lick!
You won the battle!
broadcast: {'__type': 'OnGameEnd'}
game exited gracefully
starting random run iteration 3
Go Dumbird!
Foe sent out Dumbird!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird used Tackle!
Dumbird was knocked out!
Go Bubwool!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
No other creatures available!
Dumbird used Tackle!
Bubwool used Tackle!
Dumbird was knocked out!
Go Scizard!
Bubwool used Tackle!
Scizard used Tackle!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
Bubwool used Tackle!
Scizard used Fireball!
It's not very effective...
No other creatures available!
Bubwool used Lick!
It's super effective!
Scizard used Tackle!
No other creatures available!
BotListener:on_show_event:show_text: {'text': 'No other creatures available!'}
=========================== short test summary info ============================
FAILED main_game/tests/test_whole_game.py::test_full_game_flow_random_with_bots - TypeError: 'NoneType' object is not subscriptable
========================= 1 failed, 2 passed in [REDACTED]s ==========================
PYTEST_EXIT_CODE: 1


__________________
