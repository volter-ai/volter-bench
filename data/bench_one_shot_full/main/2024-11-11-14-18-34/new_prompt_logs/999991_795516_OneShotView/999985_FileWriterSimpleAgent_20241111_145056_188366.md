Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

**Issue Description:**
1. The error indicates a timeout after 120s, suggesting the UI simulator couldn't complete its intended interactions
2. Looking at the image, I can see:
   - The battlefield layout is correct with Player and Opponent creatures
   - The UI area at the bottom shows only one button ("Tackle")
   - The creatures are properly displayed with HP values
3. The main issue appears to be related to button interaction and event handling

**Problem Analysis:**
1. The timeout error suggests that the UI simulator couldn't properly interact with the buttons
2. The code is using `availableButtonSlugs` but may not be properly handling the button state
3. The `handleSkillClick` function might not be properly emitting events

**Proposed Solution:**
1. Modify the button handling logic to ensure proper event emission
2. Add proper null checks for the skills array
3. Ensure the button state is properly managed
4. Add proper type safety for the button slugs

Here's the implementation:

# Excerpt ID: 42837992-79c0-4177-aa05-29563f60b5c2
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Shield, Swords } from 'lucide-react'
import { CreatureCard } from "@/components/ui/custom/creature/creature_card"
import { SkillButton } from "@/components/ui/custom/skill/skill_button"

interface Skill {
  __type: "Skill"
  uid: string
  display_name: string
  description: string
  stats: {
    damage: number
  }
}

interface Creature {
  __type: "Creature"
  uid: string
  display_name: string
  description: string
  stats: {
    hp: number
    max_hp: number
  }
  collections: {
    skills: Skill[]
  }
}

interface Player {
  __type: "Player"
  uid: string
  display_name: string
  collections: {
    creatures: Creature[]
  }
}

interface GameUIData {
  entities: {
    player: Player
    bot: Player
    player_creature: Creature
    bot_creature: Creature
  }
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons()

  const playerCreature = props.data?.entities?.player_creature
  const botCreature = props.data?.entities?.bot_creature

  if (!playerCreature || !botCreature) {
    return <div className="h-screen flex items-center justify-center">
      Loading battle...
    </div>
  }

  const handleSkillClick = (skillUid: string) => {
    // Only emit if the skill is available
    if (availableButtonSlugs && Array.isArray(availableButtonSlugs) && availableButtonSlugs.includes(skillUid)) {
      emitButtonClick(skillUid)
    }
  }

  const skills = playerCreature.collections?.skills || []

  return (
    <div className="h-screen w-full flex flex-col">
      {/* HUD */}
      <nav className="h-16 bg-primary flex items-center justify-between px-4">
        <div className="flex items-center gap-2">
          <Shield className="h-6 w-6" />
          <span>Battle Arena</span>
        </div>
        <Swords className="h-6 w-6" />
      </nav>

      {/* Battlefield */}
      <div className="flex-grow flex justify-between items-center px-8 bg-background">
        <div className="flex flex-col items-center gap-4">
          <span className="text-lg font-bold">Player</span>
          <CreatureCard
            uid={playerCreature.uid}
            name={playerCreature.display_name}
            hp={playerCreature.stats.hp}
            maxHp={playerCreature.stats.max_hp}
            imageUrl={`/creatures/${playerCreature.display_name.toLowerCase()}.png`}
          />
        </div>

        <div className="flex flex-col items-center gap-4">
          <span className="text-lg font-bold">Opponent</span>
          <CreatureCard
            uid={botCreature.uid}
            name={botCreature.display_name}
            hp={botCreature.stats.hp}
            maxHp={botCreature.stats.max_hp}
            imageUrl={`/creatures/${botCreature.display_name.toLowerCase()}.png`}
          />
        </div>
      </div>

      {/* UI Area */}
      <div className="h-1/4 bg-secondary p-4">
        <div className="flex flex-wrap gap-4 justify-center">
          {skills.map((skill: Skill) => {
            if (!skill?.uid) return null;
            
            const isAvailable = Array.isArray(availableButtonSlugs) && availableButtonSlugs.includes(skill.uid)
            
            return (
              <SkillButton
                key={skill.uid}
                uid={skill.uid}
                name={skill.display_name || 'Unknown Skill'}
                description={skill.description || 'No description available'}
                stats={`Damage: ${skill.stats?.damage ?? 0}`}
                disabled={!isAvailable}
                onClick={() => handleSkillClick(skill.uid)}
              />
            );
          })}
        </div>
      </div>
    </div>
  )
}
```

Key changes made:
1. Added proper null check for skills array with a default empty array
2. Improved type safety in handleSkillClick
3. Simplified the skills mapping logic
4. Ensured proper button state management through isAvailable check
5. Maintained all required props for custom UI components

These changes should resolve the timeout issue by ensuring proper button interaction and event handling.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
