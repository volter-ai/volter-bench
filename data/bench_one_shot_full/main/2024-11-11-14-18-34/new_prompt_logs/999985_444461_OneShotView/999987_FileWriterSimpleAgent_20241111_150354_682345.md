Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Looking at the image and the error, I can identify several issues:

1. The main issue appears to be that the skill buttons in the action UI area are not being rendered or are not properly interactive, leading to the timeout error in the UI simulator.

2. The image shows the battlefield with two creatures (Bubwool and Scizard) and their stats, but the lower portion where the skill buttons should be is not visible.

3. The error suggests that the UI simulator cannot interact with choices, indicating the buttons might not be properly rendered or the click handlers aren't working correctly.

Proposed Solution:

1. The map function for skills needs proper null checking and should return the Button element directly rather than wrapping it in a logical AND operation.

2. We should ensure the skills array exists before attempting to map over it.

3. Add proper key handling and ensure the button click events are properly bound.

Here's the implementation:

# Excerpt ID: ca02c4a8-7c30-4379-94ab-6515e496fa8b
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, Zap } from 'lucide-react';
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress"; 
import { Separator } from "@/components/ui/separator";

interface Skill {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
}

interface Creature {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    speed: number;
  };
  collections: {
    skills: Skill[];
  };
}

interface Player {
  uid: string;
  display_name: string;
  collections: {
    creatures: Creature[];
  };
}

interface GameUIData {
  entities: {
    player: Player;
    bot: Player;
    player_creature: Creature;
    bot_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const { availableButtonSlugs, emitButtonClick } = useCurrentButtons();

  const renderHealthBar = (current: number, max: number) => (
    <div className="w-full space-y-1">
      <Progress value={(current / max) * 100} />
      <p className="text-sm text-muted-foreground text-center">
        {current} / {max} HP
      </p>
    </div>
  );

  const renderCreatureStats = (creature: Creature, isPlayer: boolean) => (
    <Card className={`p-4 ${isPlayer ? 'bg-blue-50' : 'bg-red-50'}`}>
      <div className={`flex flex-col ${isPlayer ? 'items-start' : 'items-end'} gap-2`}>
        <h3 className="text-lg font-bold">{creature.display_name}</h3>
        <div className="flex items-center gap-2">
          <Sword className="h-4 w-4" />
          <span>{creature.stats.attack}</span>
          <Shield className="h-4 w-4" />
          <span>{creature.stats.defense}</span>
          <Zap className="h-4 w-4" />
          <span>{creature.stats.speed}</span>
        </div>
        <div className="w-48">
          {renderHealthBar(creature.stats.hp, creature.stats.max_hp)}
        </div>
      </div>
    </Card>
  );

  const renderSkillButtons = () => {
    if (!props.data.entities.player_creature?.collections.skills) {
      return null;
    }

    return props.data.entities.player_creature.collections.skills
      .filter(skill => availableButtonSlugs.includes(skill.uid))
      .map(skill => (
        <Button
          key={skill.uid}
          variant="secondary"
          onClick={() => emitButtonClick(skill.uid)}
          className="h-full flex flex-col items-center justify-center gap-2"
        >
          <span className="font-bold">{skill.display_name}</span>
          <span className="text-sm text-muted-foreground">{skill.description}</span>
          <span className="text-xs">Base Damage: {skill.stats.base_damage}</span>
        </Button>
      ));
  };

  return (
    <div className="w-full h-full flex flex-col">
      <Card className="h-[10%] flex items-center px-6 rounded-none border-b">
        <h2 className="text-xl font-bold">Battle Arena</h2>
      </Card>

      <div className="h-[60%] flex items-center justify-between px-16 bg-gradient-to-b from-background to-muted">
        <div className="flex flex-col items-center gap-4">
          <span className="text-sm text-blue-600 font-bold uppercase">Your Creature</span>
          {props.data.entities.player_creature && 
            renderCreatureStats(props.data.entities.player_creature, true)}
        </div>

        <Separator orientation="vertical" className="h-1/2" />

        <div className="flex flex-col items-center gap-4">
          <span className="text-sm text-red-600 font-bold uppercase">Opponent</span>
          {props.data.entities.bot_creature && 
            renderCreatureStats(props.data.entities.bot_creature, false)}
        </div>
      </div>

      <Card className="h-[30%] rounded-none border-t">
        <div className="grid grid-cols-2 gap-4 p-4 h-full">
          {renderSkillButtons()}
        </div>
      </Card>
    </div>
  );
}
```

The main changes are:
1. Created a separate `renderSkillButtons` function for better organization and error handling
2. Added proper filtering of skills based on `availableButtonSlugs`
3. Removed the logical AND operation that was preventing proper button rendering
4. Added null checking for the skills array

These changes should resolve the timeout issue by ensuring the buttons are properly rendered and interactive.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
