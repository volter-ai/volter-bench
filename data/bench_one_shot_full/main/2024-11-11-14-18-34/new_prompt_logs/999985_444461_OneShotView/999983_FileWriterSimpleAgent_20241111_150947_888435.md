Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and comparing it with the error message, there are several issues:

1. The skill buttons section appears to be missing entirely from the UI, despite being present in the code. This could explain the "[ERROR-001] Choices list is empty..." error.

2. The layout seems to have a large empty space in the middle where the battlefield should be, suggesting potential layout issues.

3. The timeout error suggests that the UI simulator couldn't interact with the buttons, likely because they're either not rendering or not properly connected to the game events system.

PROPOSED SOLUTION:
1. The main issue appears to be with the skill buttons rendering and connection to the game events system. We need to:
   - Ensure skill buttons are properly visible in the layout
   - Verify the connection between availableButtonSlugs and the skills
   - Add error handling for when skills are undefined
   - Adjust the layout to ensure buttons are accessible

2. We should also:
   - Add proper null checking for creature data
   - Ensure the battlefield area is properly sized
   - Add proper error boundaries

Here's the implementation:

# Excerpt ID: c8d86a7c-5c30-483f-aa56-6553ef708046
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, Zap } from 'lucide-react';
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress"; 
import { Separator } from "@/components/ui/separator";

interface Skill {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
}

interface Creature {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    speed: number;
  };
  collections: {
    skills: Skill[];
  };
}

interface Player {
  uid: string;
  display_name: string;
  collections: {
    creatures: Creature[];
  };
}

interface GameUIData {
  entities: {
    player: Player;
    bot: Player;
    player_creature: Creature;
    bot_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const { availableButtonSlugs, emitButtonClick } = useCurrentButtons();

  const renderHealthBar = (current: number, max: number) => (
    <div className="w-full space-y-1">
      <Progress value={(current / max) * 100} />
      <p className="text-sm text-muted-foreground text-center">
        {current} / {max} HP
      </p>
    </div>
  );

  const renderCreatureStats = (creature: Creature, isPlayer: boolean) => (
    <Card className={`p-4 ${isPlayer ? 'bg-blue-50' : 'bg-red-50'}`}>
      <div className={`flex flex-col ${isPlayer ? 'items-start' : 'items-end'} gap-2`}>
        <h3 className="text-lg font-bold">{creature.display_name}</h3>
        <div className="flex items-center gap-2">
          <Sword className="h-4 w-4" />
          <span>{creature.stats.attack}</span>
          <Shield className="h-4 w-4" />
          <span>{creature.stats.defense}</span>
          <Zap className="h-4 w-4" />
          <span>{creature.stats.speed}</span>
        </div>
        <div className="w-48">
          {renderHealthBar(creature.stats.hp, creature.stats.max_hp)}
        </div>
      </div>
    </Card>
  );

  const renderSkillButtons = () => {
    const skills = props.data.entities.player_creature?.collections?.skills || [];
    const availableSkills = skills.filter(skill => availableButtonSlugs.includes(skill.uid));

    if (availableSkills.length === 0) {
      return (
        <div className="p-4 text-center text-muted-foreground">
          No available actions
        </div>
      );
    }

    return (
      <div className="grid grid-cols-2 gap-4 p-4">
        {availableSkills.map(skill => (
          <Button
            key={skill.uid}
            variant="secondary"
            onClick={() => emitButtonClick(skill.uid)}
            className="p-4 h-auto flex flex-col items-center justify-center gap-2 min-h-[100px]"
          >
            <span className="font-bold">{skill.display_name}</span>
            <span className="text-sm text-muted-foreground">{skill.description}</span>
            <span className="text-xs">Base Damage: {skill.stats.base_damage}</span>
          </Button>
        ))}
      </div>
    );
  };

  if (!props.data.entities.player_creature || !props.data.entities.bot_creature) {
    return <div className="w-full h-full flex items-center justify-center">Loading...</div>;
  }

  return (
    <div className="w-full h-full flex flex-col">
      <Card className="flex-none h-16 flex items-center px-6 rounded-none border-b">
        <h2 className="text-xl font-bold">Battle Arena</h2>
      </Card>

      <div className="flex-1 flex items-center justify-between px-16 bg-gradient-to-b from-background to-muted">
        <div className="flex flex-col items-center gap-4">
          <span className="text-sm text-blue-600 font-bold uppercase">Your Creature</span>
          {renderCreatureStats(props.data.entities.player_creature, true)}
        </div>

        <Separator orientation="vertical" className="h-1/2" />

        <div className="flex flex-col items-center gap-4">
          <span className="text-sm text-red-600 font-bold uppercase">Opponent</span>
          {renderCreatureStats(props.data.entities.bot_creature, false)}
        </div>
      </div>

      <Card className="flex-none h-[200px] overflow-y-auto rounded-none border-t">
        {renderSkillButtons()}
      </Card>
    </div>
  );
}
```

Key changes made:
1. Added proper null checking for skills array
2. Simplified the skill buttons layout and added minimum height
3. Added loading state for missing creature data
4. Fixed the battlefield area sizing
5. Made the buttons section a fixed height
6. Added fallback UI for when no skills are available
7. Improved error handling throughout the component

These changes should resolve the timeout issues and ensure the UI simulator can properly interact with the buttons.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
