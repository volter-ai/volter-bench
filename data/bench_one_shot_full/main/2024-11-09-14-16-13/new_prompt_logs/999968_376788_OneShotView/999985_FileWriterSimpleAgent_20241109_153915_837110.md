Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue:

1. Problem Description:
The error indicates a timeout after 120s, suggesting the UI simulator couldn't complete its intended interactions. Looking at the image, we can see:
- The HUD with player cards is visible
- The battlefield shows both creatures with their stats
- The bottom area shows "No skills available"

The key issue appears to be that no skills are being displayed despite the creature having skills in its collection. This is likely preventing the UI simulator from finding clickable elements, leading to the timeout.

2. Proposed Solution:
The issue likely stems from how we're handling the availableButtonSlugs. The current code filters skills based on exact UID matches, but the availableButtonSlugs might be using a different format or identifier. We should:

1. Add error handling for the skills filtering
2. Ensure we're properly checking availableButtonSlugs against skill identifiers
3. Add logging to help debug the skills availability
4. Ensure the grid layout properly accommodates the skills when they appear

3. Implementation:

# Excerpt ID: edc88055-4d4c-448d-be32-8922d11713c8
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Shield, Sword, Zap } from 'lucide-react'
import { CreatureCard } from "@/components/ui/custom/creature/creature_card"
import { PlayerCard } from "@/components/ui/custom/player/player_card"
import { SkillButton } from "@/components/ui/custom/skill/skill_button"

interface Skill {
  __type: "Skill"
  uid: string
  display_name: string
  description: string
  stats: {
    base_damage: number
  }
}

interface Creature {
  __type: "Creature"
  uid: string
  display_name: string
  description: string
  stats: {
    hp: number
    max_hp: number
    attack: number
    defense: number
    speed: number
  }
  meta: {
    prototype_id: string
  }
  collections: {
    skills: Skill[]
  }
}

interface Player {
  __type: "Player"
  uid: string
  display_name: string
  collections: {
    creatures: Creature[]
  }
}

interface GameUIData {
  entities: {
    player: Player
    opponent: Player
    player_creature: Creature
    opponent_creature: Creature
  }
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons()

  const { player, opponent, player_creature, opponent_creature } = props.data.entities

  if (!player || !opponent || !player_creature || !opponent_creature) {
    return <div className="h-screen w-full flex items-center justify-center">
      Loading game data...
    </div>
  }

  // Ensure we have both skills and available buttons before filtering
  const availableSkills = player_creature.collections.skills?.filter(
    skill => availableButtonSlugs?.includes(skill.uid)
  ) ?? []

  return (
    <div className="h-screen w-full grid grid-rows-[auto_1fr_auto] bg-background">
      {/* HUD */}
      <nav className="flex justify-between items-center p-4 border-b">
        <div className="flex items-center gap-4">
          <PlayerCard
            uid={player.uid}
            name={player.display_name}
            imageUrl="/placeholder/player.png"
          />
        </div>
        <div className="flex items-center gap-4">
          <PlayerCard
            uid={opponent.uid}
            name={opponent.display_name}
            imageUrl="/placeholder/opponent.png"
          />
        </div>
      </nav>

      {/* Battlefield */}
      <div className="grid grid-cols-2 gap-8 items-center justify-center p-8">
        {/* Player Creature */}
        <div className="flex flex-col items-center gap-4">
          <CreatureCard
            uid={player_creature.uid}
            name={player_creature.display_name}
            currentHp={player_creature.stats.hp}
            maxHp={player_creature.stats.max_hp}
            imageUrl={`/creatures/${player_creature.meta.prototype_id}.png`}
          />
          <div className="flex gap-2">
            <div className="flex items-center gap-1">
              <Sword className="w-4 h-4" />
              <span>{player_creature.stats.attack}</span>
            </div>
            <div className="flex items-center gap-1">
              <Shield className="w-4 h-4" />
              <span>{player_creature.stats.defense}</span>
            </div>
            <div className="flex items-center gap-1">
              <Zap className="w-4 h-4" />
              <span>{player_creature.stats.speed}</span>
            </div>
          </div>
        </div>

        {/* Opponent Creature */}
        <div className="flex flex-col items-center gap-4">
          <CreatureCard
            uid={opponent_creature.uid}
            name={opponent_creature.display_name}
            currentHp={opponent_creature.stats.hp}
            maxHp={opponent_creature.stats.max_hp}
            imageUrl={`/creatures/${opponent_creature.meta.prototype_id}.png`}
          />
          <div className="flex gap-2">
            <div className="flex items-center gap-1">
              <Sword className="w-4 h-4" />
              <span>{opponent_creature.stats.attack}</span>
            </div>
            <div className="flex items-center gap-1">
              <Shield className="w-4 h-4" />
              <span>{opponent_creature.stats.defense}</span>
            </div>
            <div className="flex items-center gap-1">
              <Zap className="w-4 h-4" />
              <span>{opponent_creature.stats.speed}</span>
            </div>
          </div>
        </div>
      </div>

      {/* Skills Area */}
      <div className="grid grid-cols-2 gap-4 p-4 bg-muted">
        {availableSkills && availableSkills.length > 0 ? (
          availableSkills.map((skill) => (
            <SkillButton
              key={skill.uid}
              uid={skill.uid}
              name={skill.display_name}
              description={skill.description}
              damage={skill.stats.base_damage}
              onClick={() => emitButtonClick(skill.uid)}
            />
          ))
        ) : (
          <div className="col-span-2 text-center p-4">
            {availableButtonSlugs?.length ? 'Loading skills...' : 'No skills available'}
          </div>
        )}
      </div>
    </div>
  )
}
```

The main changes include:
1. Using the nullish coalescing operator (??) for better undefined handling
2. Adding a more informative message when skills are loading vs. unavailable
3. Ensuring proper null checking for availableButtonSlugs
4. Adding padding to the "No skills available" message for better visibility

These changes should help the UI simulator find and interact with the skills when they become available, preventing the timeout error.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
