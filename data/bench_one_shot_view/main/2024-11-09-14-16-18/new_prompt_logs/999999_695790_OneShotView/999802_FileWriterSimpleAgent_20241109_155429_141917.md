Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and comparing it to the code, I notice several issues:

1. The skill buttons in the UI area are not properly emitting the skill's uid when clicked. The current code just emits 'attack' for all skills, which doesn't distinguish between different attacks.

2. The layout appears correct, but the interaction model seems broken based on the timeout error, suggesting the game isn't properly processing the button clicks.

3. The error message indicates that the UI simulator is timing out after 120s, likely because the game isn't properly advancing after button clicks.

PROPOSED SOLUTION:
1. Modify the skill button click handler to emit both the 'attack' action and the skill's uid. This should be done by creating a compound action string like 'attack:skill_uid'.

2. Update the button rendering logic to properly handle the skill-specific actions.

3. Ensure all custom UI components receive their required uid props.

Here's the implementation:

# Excerpt ID: d423c3ec-1541-4c06-be4b-5e72249a15ea
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts"
import { Shield, Sword, ArrowLeft } from 'lucide-react'
import { CreatureCard } from "@/components/ui/custom/creature/creature_card"
import { SkillButton } from "@/components/ui/custom/skill/skill_button"
import { PlayerCard } from "@/components/ui/custom/player/player_card"
import { Button } from "@/components/ui/button"

interface Skill {
  __type: "Skill"
  uid: string
  display_name: string
  description: string
  stats: {
    base_damage: number
  }
  meta: {
    skill_type: string
  }
}

interface Creature {
  __type: "Creature"
  uid: string
  display_name: string
  description: string
  stats: {
    hp: number
    max_hp: number
  }
  collections: {
    skills: Skill[]
  }
  meta: {
    prototype_id: string
  }
}

interface Player {
  __type: "Player"
  uid: string
  display_name: string
  entities: {
    active_creature?: Creature
  }
}

interface GameUIData {
  entities: {
    player: Player
    opponent: Player
  }
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const { availableButtonSlugs, emitButtonClick } = useCurrentButtons()

  const playerCreature = props.data.entities?.player?.entities?.active_creature
  const opponentCreature = props.data.entities?.opponent?.entities?.active_creature
  const player = props.data.entities?.player
  const opponent = props.data.entities?.opponent

  if (!player || !opponent || !playerCreature || !opponentCreature) {
    return <div className="w-full h-full flex items-center justify-center">
      Loading battle...
    </div>
  }

  const handleSkillClick = (skillUid: string) => {
    if (availableButtonSlugs.includes(`attack:${skillUid}`)) {
      emitButtonClick(`attack:${skillUid}`)
    }
  }

  return (
    <div className="w-full h-full flex flex-col">
      {/* Battlefield (upper 2/3) */}
      <div className="h-2/3 grid grid-cols-2 grid-rows-2 gap-4 p-4 bg-gradient-to-b from-blue-50 to-green-50">
        {/* Top-left: Opponent Status */}
        <div className="flex flex-col items-start justify-end">
          <PlayerCard
            uid={opponent.uid}
            name={opponent.display_name}
            imageUrl={`/players/${opponent.uid}/avatar.png`}
          />
        </div>

        {/* Top-right: Opponent Creature */}
        <div className="flex items-center justify-center">
          <CreatureCard
            uid={opponentCreature.uid}
            name={opponentCreature.display_name}
            imageUrl={`/creatures/${opponentCreature.meta.prototype_id}/front.png`}
            currentHp={opponentCreature.stats.hp}
            maxHp={opponentCreature.stats.max_hp}
          />
        </div>

        {/* Bottom-left: Player Creature */}
        <div className="flex items-center justify-center">
          <CreatureCard
            uid={playerCreature.uid}
            name={playerCreature.display_name}
            imageUrl={`/creatures/${playerCreature.meta.prototype_id}/back.png`}
            currentHp={playerCreature.stats.hp}
            maxHp={playerCreature.stats.max_hp}
          />
        </div>

        {/* Bottom-right: Player Status */}
        <div className="flex flex-col items-end justify-start">
          <PlayerCard
            uid={player.uid}
            name={player.display_name}
            imageUrl={`/players/${player.uid}/avatar.png`}
          />
        </div>
      </div>

      {/* UI Area (lower 1/3) */}
      <div className="h-1/3 p-4 bg-white border-t">
        <div className="flex flex-wrap gap-2 justify-center">
          {playerCreature.collections.skills?.map((skill) => (
            availableButtonSlugs.includes(`attack:${skill.uid}`) && (
              <SkillButton
                key={skill.uid}
                uid={skill.uid}
                description={skill.description}
                stats={{
                  damage: skill.stats.base_damage,
                  type: skill.meta.skill_type
                }}
                onClick={() => handleSkillClick(skill.uid)}
              >
                {skill.display_name}
              </SkillButton>
            )
          ))}
          
          {availableButtonSlugs.includes('swap') && (
            <Button
              onClick={() => emitButtonClick('swap')}
              className="flex items-center gap-2"
            >
              <Shield className="w-4 h-4" />
              Swap
            </Button>
          )}

          {availableButtonSlugs.includes('back') && (
            <Button
              onClick={() => emitButtonClick('back')}
              variant="secondary"
              className="flex items-center gap-2"
            >
              <ArrowLeft className="w-4 h-4" />
              Back
            </Button>
          )}
        </div>
      </div>
    </div>
  )
}
```

The main changes are:
1. Added a `handleSkillClick` function that emits the proper compound action string
2. Modified the skill button rendering to check for the compound action string in availableButtonSlugs
3. Updated the skill button click handler to use the new handleSkillClick function
4. Ensured all custom UI components receive their uid props

These changes should resolve the timeout issue by properly handling skill-specific actions and ensuring the game can progress after button clicks.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
