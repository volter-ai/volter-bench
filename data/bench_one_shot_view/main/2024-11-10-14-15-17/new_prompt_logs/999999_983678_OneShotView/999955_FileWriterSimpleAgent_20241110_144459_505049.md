Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and provide a solution.

**Issue Description:**
Looking at the image and the error, there are several problems:
1. The UI simulator is timing out after 120s, suggesting interaction issues
2. The skills UI section shows only one button ("Tackle") when there should be multiple skills displayed in a 3-column grid
3. The error suggests connection issues with source maps, but this is likely a symptom rather than the core issue
4. The layout appears correct, but the interaction layer may be blocked

**Proposed Solution:**
1. The main issue appears to be with the skill buttons' interaction handling. The current code may not be properly managing the available button slugs.
2. We need to ensure the skill buttons are properly bound to the available choices
3. The handleSkillClick function should be modified to ensure it only emits valid button slugs
4. Add proper null checks for collections to prevent rendering issues
5. Ensure the skills grid maintains proper spacing and visibility

Here's the implementation:

# Excerpt ID: 73edfe29-0619-406b-9a9b-51d84f681362
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Shield, Sword } from 'lucide-react';
import { CreatureCard } from "@/components/ui/custom/creature/creature_card";
import { PlayerCard } from "@/components/ui/custom/player/player_card";
import { SkillButton } from "@/components/ui/custom/skill/skill_button";

interface Skill {
  __type: "Skill";
  uid: string;
  display_name: string;
  description: string;
  stats: {
    damage: number;
  };
}

interface Creature {
  __type: "Creature";
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
  };
  collections: {
    skills: Skill[];
  };
  meta: {
    prototype_id: string;
  };
}

interface Player {
  __type: "Player";
  uid: string;
  display_name: string;
  description: string;
  collections: {
    creatures: Creature[];
  };
  meta: {
    prototype_id: string;
  };
}

interface GameUIData {
  entities: {
    player: Player;
    foe: Player;
    player_creature: Creature;
    foe_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons();

  const { player, foe, player_creature, foe_creature } = props.data.entities;

  const getImageUrl = (type: string, id: string) => `/assets/${type}/${id}.png`;

  const handleSkillClick = (skillUid: string) => {
    // Only emit if the skill's uid is in the available button slugs
    const matchingSlug = availableButtonSlugs.find(slug => slug === skillUid);
    if (matchingSlug) {
      emitButtonClick(matchingSlug);
    }
  };

  return (
    <div className="h-screen w-screen bg-slate-900 text-white overflow-hidden">
      <div className="grid grid-rows-[auto_1fr_auto] h-full max-w-7xl mx-auto">
        {/* HUD */}
        <nav className="flex justify-between items-center p-4 bg-slate-800">
          {player && (
            <PlayerCard
              uid={player.uid}
              name={player.display_name}
              imageUrl={getImageUrl('player', player.meta.prototype_id)}
            />
          )}
          <div className="flex items-center gap-2">
            <Sword className="w-6 h-6" />
            <span>Battle Scene</span>
          </div>
          {foe && (
            <PlayerCard
              uid={foe.uid}
              name={foe.display_name}
              imageUrl={getImageUrl('player', foe.meta.prototype_id)}
            />
          )}
        </nav>

        {/* Battlefield */}
        <div className="flex justify-between items-center p-8 gap-8">
          {player_creature && (
            <div className="relative flex-1">
              <span className="absolute -top-8 left-1/2 transform -translate-x-1/2 text-green-400">
                Your Creature
              </span>
              <CreatureCard
                uid={player_creature.uid}
                name={player_creature.display_name}
                hp={player_creature.stats.hp}
                maxHp={player_creature.stats.max_hp}
                imageUrl={getImageUrl('creature', player_creature.meta.prototype_id)}
              />
            </div>
          )}

          {foe_creature && (
            <div className="relative flex-1">
              <span className="absolute -top-8 left-1/2 transform -translate-x-1/2 text-red-400">
                Enemy Creature
              </span>
              <CreatureCard
                uid={foe_creature.uid}
                name={foe_creature.display_name}
                hp={foe_creature.stats.hp}
                maxHp={foe_creature.stats.max_hp}
                imageUrl={getImageUrl('creature', foe_creature.meta.prototype_id)}
              />
            </div>
          )}
        </div>

        {/* Skills UI */}
        <div className="bg-slate-800 p-6">
          <div className="grid grid-cols-3 gap-4 max-w-4xl mx-auto">
            {player_creature?.collections?.skills?.map((skill) => (
              <SkillButton
                key={skill.uid}
                uid={skill.uid}
                name={skill.display_name}
                description={skill.description}
                stats={`Damage: ${skill.stats.damage}`}
                disabled={!availableButtonSlugs.includes(skill.uid)}
                onClick={() => handleSkillClick(skill.uid)}
              />
            ))}
          </div>
        </div>
      </div>
    </div>
  );
}
```

Key changes made:
1. Modified handleSkillClick to ensure it only emits valid slugs
2. Added proper null checking for skills collection using optional chaining
3. Adjusted grid gap from gap-6 to gap-4 for better button spacing
4. Ensured all custom UI components receive uid props
5. Maintained strict typing and interface compliance

These changes should resolve the timeout issues by ensuring proper button interaction and state management.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
