Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and error, there are several issues:
1. The UI simulator timeout suggests that the interactive elements (buttons) aren't properly clickable or accessible
2. The bottom third of the screen appears empty - the skill buttons that should be visible in the UI area are not showing
3. The error indicates a connection refusal, which combined with the missing UI elements suggests there might be an issue with how we're handling the available button slugs

PROPOSED SOLUTION:
1. The main issue appears to be with the button filtering logic. The current code filters skills based on `availableButtonSlugs`, but if this is null/undefined, no skills will be shown
2. We should modify the filter condition to show all skills when `availableButtonSlugs` is empty/null
3. We should ensure the grid layout for skills is properly constrained
4. Add proper error handling for when button slugs aren't available

Here's the complete fixed code:

# Excerpt ID: c4cd441d-4e2e-4087-b849-82df94264876
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices";
import { CreatureCard } from "@/components/ui/custom/creature/creature_card";
import { SkillButton } from "@/components/ui/custom/skill/skill_button";

interface Skill {
  __type: "Skill";
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
  meta: {
    prototype_id: string;
    category: string;
    skill_type: string;
    is_physical: boolean;
  };
}

interface Creature {
  __type: "Creature";
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    sp_attack: number;
    sp_defense: number;
    speed: number;
  };
  meta: {
    prototype_id: string;
    category: string;
    creature_type: string;
  };
  collections: {
    skills: Skill[];
  };
}

interface GameUIData {
  entities: {
    player_creature: Creature;
    opponent_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const { availableButtonSlugs, emitButtonClick } = useCurrentButtons();

  const playerCreature = props.data.entities.player_creature;
  const opponentCreature = props.data.entities.opponent_creature;

  if (!playerCreature || !opponentCreature) {
    return <div className="h-screen w-screen flex items-center justify-center">Loading...</div>;
  }

  const visibleSkills = playerCreature.collections.skills.filter(skill => 
    !availableButtonSlugs || availableButtonSlugs.length === 0 || availableButtonSlugs.includes(skill.uid)
  );

  return (
    <div className="h-screen w-screen flex flex-col">
      {/* Battlefield Area - Upper 2/3 */}
      <div className="h-2/3 grid grid-cols-2 grid-rows-2 bg-slate-200 p-4 gap-4">
        {/* Opponent Status - Top Left */}
        <div className="flex items-center justify-center">
          <CreatureCard
            uid={opponentCreature.uid}
            name={opponentCreature.display_name}
            hp={opponentCreature.stats.hp}
            maxHp={opponentCreature.stats.max_hp}
            imageUrl={`/assets/creatures/${opponentCreature.meta.prototype_id}.png`}
          />
        </div>

        {/* Opponent Creature - Top Right */}
        <div className="flex items-center justify-center">
          <div className="relative">
            <img 
              src={`/assets/creatures/${opponentCreature.meta.prototype_id}.png`}
              alt={opponentCreature.display_name}
              className="w-48 h-48 object-contain"
            />
            <div className="absolute bottom-0 w-full h-4 bg-black/20 rounded-full blur-sm" />
          </div>
        </div>

        {/* Player Creature - Bottom Left */}
        <div className="flex items-center justify-center">
          <div className="relative">
            <img 
              src={`/assets/creatures/${playerCreature.meta.prototype_id}.png`}
              alt={playerCreature.display_name}
              className="w-48 h-48 object-contain"
            />
            <div className="absolute bottom-0 w-full h-4 bg-black/20 rounded-full blur-sm" />
          </div>
        </div>

        {/* Player Status - Bottom Right */}
        <div className="flex items-center justify-center">
          <CreatureCard
            uid={playerCreature.uid}
            name={playerCreature.display_name}
            hp={playerCreature.stats.hp}
            maxHp={playerCreature.stats.max_hp}
            imageUrl={`/assets/creatures/${playerCreature.meta.prototype_id}.png`}
          />
        </div>
      </div>

      {/* UI Area - Lower 1/3 */}
      <div className="h-1/3 bg-slate-100 p-4">
        <div className="grid grid-cols-2 gap-4 h-full">
          {visibleSkills.map((skill) => (
            <SkillButton
              key={skill.uid}
              uid={skill.uid}
              skillName={skill.display_name}
              description={skill.description}
              damage={skill.stats.base_damage}
              type={skill.meta.skill_type}
              onClick={() => emitButtonClick(skill.uid)}
            />
          ))}
        </div>
      </div>
    </div>
  );
}
```

Key changes made:
1. Added a `visibleSkills` variable to handle the skill filtering logic more clearly
2. Modified the filter condition to show all skills when `availableButtonSlugs` is empty or null
3. Moved the filter logic outside of the JSX for better readability and maintenance
4. Maintained all required props for custom UI components

These changes should resolve the timeout issue by ensuring the skill buttons are always visible and properly interactive.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
