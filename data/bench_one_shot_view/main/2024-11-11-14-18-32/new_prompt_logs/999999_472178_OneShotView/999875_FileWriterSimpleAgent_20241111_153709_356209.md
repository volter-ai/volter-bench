Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and comparing it to the code, there are several issues:

1. The creatures' cards are not properly spaced - they appear to be overlapping or misaligned
2. The skills UI section at the bottom appears to be empty or not visible
3. The timeout error suggests that the UI simulator cannot find clickable elements
4. The layout structure in the code shows the creatures side by side, but they're not properly positioned

The main issue seems to be that the button interactions aren't working properly, likely due to layout issues preventing proper click detection.

PROPOSED SOLUTION:

1. Fix the battlefield layout to properly position the creatures
   - Adjust the flex container to use proper spacing
   - Add proper padding and margins

2. Ensure the skills UI is properly rendered and accessible
   - Add proper height constraints
   - Ensure buttons are properly rendered and clickable
   - Fix the grid layout for skills

3. Add proper click handling for the skills
   - Ensure buttons are properly rendered when available
   - Fix the button ID construction

Here's the implementation:

# Excerpt ID: dfdb1c50-b025-428b-b1f7-1df7314096be
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, Zap, Heart } from 'lucide-react';
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress";

interface Creature {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    speed: number;
  };
  collections: {
    skills: Skill[];
  };
}

interface Skill {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
  meta: {
    prototype_id: string;
  };
}

interface GameUIData {
  entities: {
    player: {
      uid: string;
      stats: Record<string, number>;
    };
    opponent: {
      uid: string;
      stats: Record<string, number>;
    };
    player_creature: Creature;
    opponent_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons();

  const playerCreature = props.data?.entities?.player_creature;
  const opponentCreature = props.data?.entities?.opponent_creature;

  if (!playerCreature || !opponentCreature) {
    return <div className="w-full h-screen flex items-center justify-center">
      Loading battle...
    </div>;
  }

  const renderCreatureStats = (creature: Creature, isPlayer: boolean) => (
    <Card className={`p-4 ${isPlayer ? 'ml-auto mr-8' : 'ml-8 mr-auto'} w-64`}>
      <div className="flex flex-col gap-2">
        <h2 className="text-xl font-bold">{creature.display_name}</h2>
        <div className="w-full">
          <Progress 
            value={(creature.stats.hp / creature.stats.max_hp) * 100}
            className="h-2"
          />
          <span className="text-sm">
            {creature.stats.hp}/{creature.stats.max_hp} HP
          </span>
        </div>
        <div className="flex gap-4 mt-2">
          <div className="flex items-center">
            <Sword className="w-4 h-4 mr-1" />
            {creature.stats.attack}
          </div>
          <div className="flex items-center">
            <Shield className="w-4 h-4 mr-1" />
            {creature.stats.defense}
          </div>
          <div className="flex items-center">
            <Zap className="w-4 h-4 mr-1" />
            {creature.stats.speed}
          </div>
        </div>
      </div>
    </Card>
  );

  return (
    <div className="w-full h-screen flex flex-col bg-gradient-to-b from-blue-900 to-blue-800">
      {/* HUD */}
      <Card className="w-full p-4 rounded-none bg-black/30">
        <div className="flex justify-between items-center">
          <span className="text-white">Battle Scene</span>
          <Heart className="text-red-500" />
        </div>
      </Card>

      {/* Battlefield */}
      <div className="flex-1 flex items-center px-4">
        <div className="w-1/2 flex justify-end">
          {renderCreatureStats(playerCreature, true)}
        </div>
        <div className="w-1/2 flex justify-start">
          {renderCreatureStats(opponentCreature, false)}
        </div>
      </div>

      {/* Skills UI */}
      <Card className="min-h-[240px] bg-black/40 p-4 rounded-t-xl rounded-b-none">
        <div className="grid grid-cols-2 gap-4">
          {playerCreature.collections.skills.map((skill) => {
            const buttonId = `skill-${skill.meta.prototype_id}`;
            const isAvailable = availableButtonSlugs.includes(buttonId);
            
            return isAvailable && (
              <Button
                key={skill.uid}
                onClick={() => emitButtonClick(buttonId)}
                variant="secondary"
                className="h-auto flex flex-col items-start p-4"
              >
                <h3 className="font-bold">{skill.display_name}</h3>
                <p className="text-sm opacity-80">{skill.description}</p>
                <span className="text-xs">Damage: {skill.stats.base_damage}</span>
              </Button>
            );
          })}
        </div>
      </Card>
    </div>
  );
}
```

Key changes made:
1. Fixed the battlefield layout with proper width constraints and positioning
2. Added minimum height to skills UI to ensure visibility
3. Fixed button ID construction to match expected format
4. Improved creature card positioning with proper margins and width
5. Added proper padding to the battlefield container
6. Simplified the button availability check
7. Made the skills section more robust with proper sizing

These changes should resolve the timeout issues by making all elements properly visible and clickable.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
