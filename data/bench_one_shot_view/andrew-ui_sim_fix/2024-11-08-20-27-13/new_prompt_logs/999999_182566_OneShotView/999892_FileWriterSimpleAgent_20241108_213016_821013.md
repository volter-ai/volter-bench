Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Looking at the image and the error, I can identify several issues:

1. The layout appears incorrect - the player and opponent creatures are too close together and not properly positioned on opposite sides
2. The skills UI section appears to be missing entirely from the visible area
3. The timeout error suggests that the UI simulator cannot interact with the buttons, likely because they're either not visible or not properly rendered

The main problems appear to be:

1. The battlefield layout is using incorrect flex positioning
2. The skills UI may be pushed off-screen due to height constraints
3. The button rendering logic may be preventing buttons from appearing

Here's my proposed solution:

1. Fix the battlefield layout by:
   - Adjusting the flex container to properly space creatures
   - Removing the width constraints that are causing overlap
2. Adjust the skills UI by:
   - Ensuring it has proper height constraints
   - Making sure it's visible within the viewport
3. Fix the button rendering logic by:
   - Ensuring the skillId comparison is correct
   - Adding proper key handling

Here's the corrected code:

# Excerpt ID: 5fedc79f-c9b7-4c43-a833-98fc2d0c12ba
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, Zap, Heart } from 'lucide-react';
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress";

interface Creature {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    speed: number;
  };
  collections: {
    skills: Skill[];
  };
}

interface Skill {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
  meta: {
    prototype_id: string;
  };
}

interface GameUIData {
  entities: {
    player: {
      uid: string;
      stats: Record<string, number>;
    };
    opponent: {
      uid: string;
      stats: Record<string, number>;
    };
    player_creature: Creature;
    opponent_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons();

  const playerCreature = props.data?.entities?.player_creature;
  const opponentCreature = props.data?.entities?.opponent_creature;

  if (!playerCreature || !opponentCreature) {
    return <div className="w-full h-screen flex items-center justify-center">
      Loading battle...
    </div>;
  }

  const renderCreatureStats = (creature: Creature, isPlayer: boolean) => (
    <Card className={`p-4 ${isPlayer ? 'ml-16' : 'mr-16'}`}>
      <div className="flex flex-col gap-2">
        <h2 className="text-xl font-bold">{creature.display_name}</h2>
        <div className="w-full">
          <Progress 
            value={(creature.stats.hp / creature.stats.max_hp) * 100}
            className="h-2"
          />
          <span className="text-sm">
            {creature.stats.hp}/{creature.stats.max_hp} HP
          </span>
        </div>
        <div className="flex gap-4 mt-2">
          <div className="flex items-center">
            <Sword className="w-4 h-4 mr-1" />
            {creature.stats.attack}
          </div>
          <div className="flex items-center">
            <Shield className="w-4 h-4 mr-1" />
            {creature.stats.defense}
          </div>
          <div className="flex items-center">
            <Zap className="w-4 h-4 mr-1" />
            {creature.stats.speed}
          </div>
        </div>
      </div>
    </Card>
  );

  return (
    <div className="w-full h-screen flex flex-col">
      <Card className="w-full rounded-none border-b">
        <div className="flex justify-between items-center p-2">
          <span>Battle Scene</span>
          <Heart className="text-red-500" />
        </div>
      </Card>

      <div className="flex-1 flex items-center bg-gradient-to-b from-blue-900/10">
        <div className="flex-1 flex justify-center">
          <div className="text-center">
            <div className="mb-2">Player</div>
            {renderCreatureStats(playerCreature, true)}
          </div>
        </div>
        <div className="flex-1 flex justify-center">
          <div className="text-center">
            <div className="mb-2">Opponent</div>
            {renderCreatureStats(opponentCreature, false)}
          </div>
        </div>
      </div>

      <Card className="min-h-[200px] max-h-[40vh] rounded-none border-t overflow-y-auto">
        <div className="grid grid-cols-2 gap-4 p-4">
          {playerCreature.collections.skills.map((skill) => {
            const skillId = `skill-${skill.meta.prototype_id}`;
            const isAvailable = availableButtonSlugs.includes(skillId);
            
            return isAvailable && (
              <Button
                key={skill.uid}
                onClick={() => emitButtonClick(skillId)}
                variant="outline"
                className="h-auto flex flex-col items-start p-4"
              >
                <span className="font-bold">{skill.display_name}</span>
                <span className="text-sm opacity-80">{skill.description}</span>
                <span className="text-xs mt-1">Damage: {skill.stats.base_damage}</span>
              </Button>
            );
          })}
        </div>
      </Card>
    </div>
  );
}
```

Key changes made:
1. Fixed battlefield layout with proper flex spacing and centering
2. Added proper height constraints to the skills UI section
3. Fixed the skillId construction to match the expected format
4. Improved button visibility and interaction handling
5. Added overflow handling for the skills section
6. Adjusted margins for better creature card spacing

These changes should resolve the timeout issue by ensuring all UI elements are properly visible and interactive.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
