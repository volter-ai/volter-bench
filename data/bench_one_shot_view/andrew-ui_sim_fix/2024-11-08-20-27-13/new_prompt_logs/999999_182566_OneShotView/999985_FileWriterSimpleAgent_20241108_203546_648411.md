Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and comparing it to the code, I notice several issues:

1. The skills area appears to only show one button ("Tackle") instead of the grid of skills that should be shown from the creature's skill collection
2. The timeout error suggests that the UI simulator cannot properly interact with the choices/buttons
3. The main issue appears to be related to button slugs not being properly connected to the skills

The core problem seems to be a mismatch between the skill UIDs and the available button slugs. The code is trying to use skill UIDs directly as button slugs, which is likely incorrect.

PROPOSED SOLUTION:
1. Add a `slug` property to the Skill interface to properly map skills to button slugs
2. Modify the skill button rendering logic to use the skill's slug for availability checking
3. Update the click handler to emit the correct slug
4. Ensure proper null checking for collections

Here's the implementation:

# Excerpt ID: 03cc9eaf-a5c9-4547-b248-e4eb2aef5cb1
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, User } from 'lucide-react';
import { CreatureCard } from "@/components/ui/custom/creature/creature_card";
import { SkillButton } from "@/components/ui/custom/skill/skill_button";

interface Skill {
  __type: "Skill";
  uid: string;
  display_name: string;
  description: string;
  slug: string;
  stats: {
    damage: number;
  };
}

interface Creature {
  __type: "Creature";
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
  };
  collections: {
    skills: Skill[];
  };
  meta: {
    prototype_id: string;
  };
}

interface Player {
  __type: "Player";
  uid: string;
  display_name: string;
  collections: {
    creatures: Creature[];
  };
}

interface GameUIData {
  entities: {
    player: Player;
    foe: Player;
    player_creature: Creature;
    foe_creature: Creature;
  };
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons();

  const { player_creature, foe_creature } = props.data.entities;

  if (!player_creature || !foe_creature) {
    return <div className="w-full h-full flex items-center justify-center">
      Loading battle...
    </div>;
  }

  const getCreatureImage = (creature: Creature) => 
    `/assets/creatures/${creature.meta.prototype_id}.png`;

  const handleSkillClick = (skill: Skill) => {
    if (availableButtonSlugs.includes(skill.slug)) {
      emitButtonClick(skill.slug);
    }
  };

  return (
    <div className="w-full h-full grid grid-rows-[auto_1fr_auto] gap-4 p-4 bg-background">
      {/* Top HUD */}
      <nav className="flex justify-between items-center p-2 bg-muted rounded-lg">
        <div className="flex items-center gap-2">
          <User className="w-4 h-4" />
          <span>{props.data.entities.player?.display_name || "Unknown Player"}</span>
        </div>
        <div className="flex items-center gap-2">
          <Sword className="w-4 h-4" />
          <Shield className="w-4 h-4" />
        </div>
      </nav>

      {/* Battlefield */}
      <div className="flex justify-between items-center px-8">
        <div className="relative">
          <span className="absolute -top-6 left-1/2 -translate-x-1/2 text-sm font-bold">
            Your Creature
          </span>
          <CreatureCard
            uid={player_creature.uid}
            name={player_creature.display_name}
            hp={player_creature.stats.hp}
            maxHp={player_creature.stats.max_hp}
            imageUrl={getCreatureImage(player_creature)}
          />
        </div>

        <div className="relative">
          <span className="absolute -top-6 left-1/2 -translate-x-1/2 text-sm font-bold">
            Opponent's Creature
          </span>
          <CreatureCard
            uid={foe_creature.uid}
            name={foe_creature.display_name}
            hp={foe_creature.stats.hp}
            maxHp={foe_creature.stats.max_hp}
            imageUrl={getCreatureImage(foe_creature)}
          />
        </div>
      </div>

      {/* Skills/UI Area */}
      <div className="bg-muted p-4 rounded-lg">
        <div className="grid grid-cols-4 gap-4">
          {(player_creature.collections.skills || []).map((skill) => (
            <SkillButton
              key={skill.uid}
              uid={skill.uid}
              name={skill.display_name}
              description={skill.description}
              stats={`Damage: ${skill.stats.damage}`}
              disabled={!availableButtonSlugs.includes(skill.slug)}
              onClick={() => handleSkillClick(skill)}
            />
          ))}
        </div>
      </div>
    </div>
  );
}
```

Key changes made:
1. Added `slug` to the Skill interface to properly map skills to button slugs
2. Modified handleSkillClick to take the full skill object and use its slug
3. Updated the skill button mapping to use proper null coalescing
4. Changed the disabled check to use skill.slug instead of skill.uid
5. Updated the click handler to pass the full skill object

These changes ensure that the button slugs are properly mapped and that the UI simulator can interact with the buttons correctly.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
