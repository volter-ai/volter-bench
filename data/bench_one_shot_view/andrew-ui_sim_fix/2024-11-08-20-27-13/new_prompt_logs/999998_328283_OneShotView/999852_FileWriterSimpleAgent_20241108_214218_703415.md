Role: system
Content: You are a helpful assistant specialized in changing files based on proposed changes.
__________________
Role: user
Content: ## Proposed Code Change
Let me analyze the issue and propose a solution.

DIAGNOSIS:
Looking at the image and the error message, there are several issues:

1. The main error is a timeout after 120s, suggesting the UI simulator couldn't interact with the choices properly
2. The creature cards are visible but seem to be floating in a large empty space
3. The "Waiting for available actions..." message is showing, indicating no skills are being displayed
4. The height calculations in the current layout might be causing issues with element visibility and interaction

PROPOSED SOLUTION:

1. Fix the height calculations:
- Remove the h-screen from the main container as it might cause overflow issues
- Adjust the height percentages to ensure all elements fit within the viewport
- Use min-height where appropriate to prevent content squishing

2. Improve the skill button accessibility:
- Add proper aria-labels for better accessibility
- Ensure buttons are properly sized and positioned
- Add proper keyboard navigation support

3. Adjust the layout structure:
- Make the container more flexible with min-height instead of fixed height
- Ensure the battle area and UI area are properly proportioned
- Add proper overflow handling

Here's the implementation:

# Excerpt ID: 51ed6e76-cd4d-44b3-8d80-7f779f3baddf
```jsx main_game/templates/MainGameScene.tsx
import { useCurrentButtons } from "@/lib/useChoices.ts";
import { Sword, Shield, Zap, Heart } from 'lucide-react';
import { Card, CardHeader, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

interface Skill {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    base_damage: number;
  };
}

interface Creature {
  uid: string;
  display_name: string;
  description: string;
  stats: {
    hp: number;
    max_hp: number;
    attack: number;
    defense: number;
    speed: number;
  };
  collections: {
    skills: Skill[];
  };
}

interface GameUIData {
  entities: {
    player_creature: Creature;
    opponent_creature: Creature;
  };
}

function CreatureCard({ creature, isPlayer }: { creature: Creature; isPlayer: boolean }) {
  return (
    <Card className="w-2/5 hover:shadow-lg transition-shadow" key={creature.uid}>
      <CardHeader className="pb-2">
        <h3 className="text-lg font-bold">{creature.display_name}</h3>
      </CardHeader>
      <CardContent>
        <div className="mb-2 bg-gray-200 rounded-full">
          <div 
            className={`${isPlayer ? 'bg-green-500' : 'bg-red-500'} rounded-full h-3`}
            style={{
              width: `${(creature.stats.hp / creature.stats.max_hp) * 100}%`
            }}
          />
        </div>
        <div className="flex gap-3 text-sm">
          <div className="flex items-center">
            <Heart className="w-4 h-4 mr-1" />
            {creature.stats.hp}/{creature.stats.max_hp}
          </div>
          <div className="flex items-center">
            <Sword className="w-4 h-4 mr-1" />
            {creature.stats.attack}
          </div>
          <div className="flex items-center">
            <Shield className="w-4 h-4 mr-1" />
            {creature.stats.defense}
          </div>
          <div className="flex items-center">
            <Zap className="w-4 h-4 mr-1" />
            {creature.stats.speed}
          </div>
        </div>
      </CardContent>
    </Card>
  );
}

function SkillButton({ skill, onClick }: { skill: Skill; onClick: () => void }) {
  return (
    <Button 
      key={skill.uid}
      onClick={onClick}
      className="w-full h-[100px] flex flex-col items-start p-4 cursor-pointer hover:scale-[1.02] transition-transform"
      variant="default"
      aria-label={`Use skill ${skill.display_name}`}
    >
      <span className="font-bold text-lg">{skill.display_name}</span>
      <span className="text-sm">{skill.description}</span>
      <span className="text-sm mt-1">Damage: {skill.stats.base_damage}</span>
    </Button>
  );
}

export function MainGameSceneView(props: { data: GameUIData }) {
  const {
    availableButtonSlugs,
    emitButtonClick
  } = useCurrentButtons();

  const playerCreature = props.data?.entities?.player_creature;
  const opponentCreature = props.data?.entities?.opponent_creature;

  if (!playerCreature || !opponentCreature) {
    return <div className="w-full min-h-screen flex items-center justify-center">
      Loading battle...
    </div>;
  }

  const availableSkills = playerCreature.collections.skills.filter(skill => 
    availableButtonSlugs.includes(skill.uid)
  );

  return (
    <div className="w-full min-h-screen flex flex-col bg-slate-100">
      <Card className="w-full flex-none h-16 bg-slate-800 text-white rounded-none z-10">
        <CardContent className="flex items-center justify-between p-4">
          <span className="font-bold text-lg">{playerCreature.display_name}</span>
          <span className="font-bold text-lg">{opponentCreature.display_name}</span>
        </CardContent>
      </Card>

      <div className="w-full flex-1 min-h-[400px] flex items-center justify-between px-16 bg-gradient-to-b from-slate-200 to-slate-300">
        <CreatureCard creature={playerCreature} isPlayer={true} />
        <CreatureCard creature={opponentCreature} isPlayer={false} />
      </div>

      <Card className="w-full flex-none min-h-[300px] shadow-inner rounded-none z-20">
        <CardContent className="p-6">
          {availableSkills.length > 0 ? (
            <div className="grid grid-cols-2 gap-6">
              {availableSkills.map((skill) => (
                <SkillButton 
                  key={skill.uid}
                  skill={skill}
                  onClick={() => emitButtonClick(skill.uid)}
                />
              ))}
            </div>
          ) : (
            <div className="w-full h-full flex items-center justify-center text-gray-500 text-lg">
              Waiting for available actions...
            </div>
          )}
        </CardContent>
      </Card>
    </div>
  );
}
```

The main changes include:
1. Replaced fixed heights with flex-based layout
2. Added min-height constraints to ensure proper spacing
3. Improved button accessibility with aria-labels
4. Adjusted the container heights to use flex-grow and flex-none appropriately
5. Made the layout more responsive to different screen sizes
6. Added proper height constraints to prevent overflow issues

These changes should resolve the timeout issue by making the UI more stable and accessible to the simulator.

## Directions
Reply with a list of actions in the following format. The response should only contain the JSON list of actions, no other text.
Make sure you are using the excerpt_id which contains the entire contents of the file.

Each action in the list must have these fields:
- action: Must be "overwrite"
- excerpt_id: The ID of the excerpt to use
- file_path: The relative path to the file

Example format for multiple files:
[
    {
        "action": "overwrite",
        "excerpt_id": "abc1",
        "file_path": "src/main.py"
    },
    {
        "action": "overwrite",
        "excerpt_id": "def2",
        "file_path": "tests/test_main.py"
    }
]
__________________
Role: assistant
Content: 
__________________
